<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ETHIO BINGO</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        :root { --gold: #facc15; --bg: #0f172a; --card: #1e293b; --green: #22c55e; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', Arial, sans-serif; margin: 0; overflow-x: hidden; }
        
        /* 1. Transition & Logo Section */
        #splash { position: fixed; inset: 0; background: var(--bg); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1000; transition: 0.8s ease-out; }
        .logo { width: 150px; height: 150px; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold; color: black; box-shadow: 0 0 30px var(--gold); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        /* 3. Header Styling */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #111827; }
        .user-info { font-size: 0.9rem; }
        .top-btns { display: flex; gap: 8px; }
        .btn-sm { padding: 8px 12px; border-radius: 5px; border: none; font-size: 0.8rem; font-weight: bold; cursor: pointer; }
        .btn-deposit { background: var(--green); color: white; }
        .btn-refresh { background: var(--card); color: white; border: 1px solid #444; }

        /* Balance Display */
        .balance-card { text-align: right; padding: 0 15px; margin-bottom: 20px; }
        .balance-card span { font-size: 0.8rem; color: #94a3b8; }
        .balance-card h2 { margin: 0; color: var(--green); font-size: 1.8rem; }

        /* 4. Price Tabs */
        .price-tabs { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; }
        .tab { background: var(--card); padding: 15px; border-radius: 10px; border: 1px solid #334155; transition: 0.3s; cursor: pointer; }
        .tab:active { transform: scale(0.95); background: #334155; }
        .tab b { display: block; font-size: 1.2rem; color: var(--gold); }
        .tab span { font-size: 0.7rem; color: #94a3b8; }

        /* Registration Modal */
        #reg-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 20px; }
        .modal-content { background: var(--card); padding: 25px; border-radius: 15px; width: 100%; text-align: center; }
        input { width: 100%; padding: 12px; margin: 15px 0; border-radius: 8px; border: 1px solid #444; background: #0f172a; color: white; box-sizing: border-box; }

        /* Card Selector */
        #card-selector { display: none; padding: 15px; animation: slideUp 0.5s ease; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .grid-200 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 15px; }
        .bingo-card-btn { background: var(--card); border: 1px solid var(--gold); color: white; padding: 10px; border-radius: 5px; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="logo">ETHIO<br>BINGO</div>
        <p style="margin-top:20px; color:var(--gold)">·â†·àò·å´·äï ·àã·ã≠...</p>
    </div>

    <div id="main-app">
        <div class="header">
            <div class="user-info">·à∞·àã·àù·ç£ <br><b id="p-name">·â∞·å´·ãã·âΩ</b></div>
            <div class="top-btns">
                <button class="btn-sm btn-deposit" onclick="showDeposit()">·åà·äï·ãò·â• ·ã´·àµ·åà·â°</button>
                <button class="btn-sm btn-refresh" onclick="location.reload()">üîÑ</button>
            </div>
        </div>

        <div class="balance-card">
            <span>·âÄ·à™ ·àÇ·à≥·â•</span>
            <h2 id="u-bal">0.00 ETB</h2>
        </div>

        <div class="price-tabs">
            <div class="tab" onclick="checkBalance(10)"><b>10</b> <span>ETB</span></div>
            <div class="tab" onclick="checkBalance(20)"><b>20</b> <span>ETB</span></div>
            <div class="tab" onclick="checkBalance(50)"><b>50</b> <span>ETB</span></div>
            <div class="tab" onclick="checkBalance(100)"><b>100</b> <span>ETB</span></div>
            <div class="tab" onclick="checkBalance(500)"><b>500</b> <span>ETB</span></div>
            <div class="tab" onclick="checkBalance(1000)"><b>1000</b> <span>ETB</span></div>
        </div>

        <div id="card-selector">
            <h3 style="color:var(--gold)">·ä´·à≠·â¥·àã ·ã≠·àù·à®·å° (ID: 001-200)</h3>
            <div class="grid-200" id="cards-container"></div>
        </div>
    </div>

    <div id="reg-modal">
        <div class="modal-content">
            <h3>·ã≠·àò·ãù·åà·â°</h3>
            <p>·àà·àò·âÄ·å†·àç ·ä•·â£·ä≠·ãé ·ã®·â¥·àå·åç·à´·àù ·àµ·àç·ä≠ ·âÅ·å•·à≠·ãé·äï ·ã´·àµ·åà·â°</p>
            <input type="tel" id="p-phone" placeholder="09xxxxxxxx">
            <button class="btn-sm btn-deposit" style="width:100%; padding:15px;" onclick="registerUser()">·ã≠·àò·ãù·åà·â°</button>
        </div>
    </div>

    <script>
        // Configs
        const ADMIN_ID = 8431270634;
        const firebaseConfig = { databaseURL: "https://dagi-bingo-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const tg = window.Telegram.WebApp;
        tg.expand();

        let userBal = 0;
        let isRegistered = false;

        // 1. Splash Screen Timeout
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => document.getElementById('splash').style.display = 'none', 800);
        }, 2000);

        // Load User Data
        if(tg.initDataUnsafe.user) {
            const user = tg.initDataUnsafe.user;
            document.getElementById('p-name').innerText = user.first_name;
            
            // Check Registration
            db.ref('users/' + user.id).once('value', (s) => {
                if(!s.exists()) {
                    document.getElementById('reg-modal').style.display = 'flex';
                } else {
                    isRegistered = true;
                    userBal = s.val().bal || 0;
                    updateUI();
                }
            });
        }

        function registerUser() {
            const phone = document.getElementById('p-phone').value;
            if(phone.length < 10) return alert("·âµ·ä≠·ä≠·àà·äõ ·àµ·àç·ä≠ ·ã´·àµ·åà·â°");
            
            db.ref('users/' + tg.initDataUnsafe.user.id).set({
                name: tg.initDataUnsafe.user.first_name,
                phone: phone,
                bal: 0,
                id: tg.initDataUnsafe.user.id
            }).then(() => {
                document.getElementById('reg-modal').style.display = 'none';
                isRegistered = true;
                alert("·àù·ãù·åà·â£ ·â∞·à≥·ä≠·â∑·àç!");
            });
        }

        function updateUI() {
            document.getElementById('u-bal').innerText = userBal.toFixed(2) + " ETB";
        }

        function showDeposit() {
            alert("·â†·â¥·àå·â•·à≠ (0991243423) ·â•·à≠ ·ã´·àµ·åà·â° ·ä•·äì ·àà @admin (ID: " + ADMIN_ID + ") ·ã®·âµ·à´·äï·ãõ·ä≠·àΩ·äï ·âÅ·å•·à©·äï ·ã≠·àã·ä©·ç¢");
        }

        function checkBalance(price) {
            if(userBal < price) {
                alert("·ä•·â£·ä≠·ãé ·àÇ·à≥·â• ·ã´·àµ·åà·â°! ·âÄ·à™ ·àÇ·à≥·â•·ãé ·ä® " + price + " ·â•·à≠ ·â†·â≥·âΩ ·äê·ãç·ç¢");
            } else {
                showCards(price);
            }
        }

        function showCards(price) {
            document.querySelector('.price-tabs').style.display = 'none';
            document.getElementById('card-selector').style.display = 'block';
            const container = document.getElementById('cards-container');
            container.innerHTML = "";
            for(let i=1; i<=200; i++) {
                let b = document.createElement('button');
                b.className = 'bingo-card-btn';
                b.innerText = "·ä´·à≠·â¥·àã #" + i;
                b.onclick = () => alert("·ä´·à≠·â¥·àã #" + i + " ·â∞·àò·à≠·åß·àç (·ãã·åã: " + price + ")");
                container.appendChild(b);
            }
        }
    </script>
</body>
</html>

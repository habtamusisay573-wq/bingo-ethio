<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BINGO ETHIO MASTER</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --green: #009b3a; --yellow: #fed100; --red: #ef3340; --dark: #0f172a; }
        body { background: var(--dark); color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 10px; }
        
        .header { background: #1e293b; padding: 15px; border-bottom: 4px solid var(--yellow); }
        #current-num { font-size: 3rem; font-weight: 900; color: var(--yellow); display: block; }
        #card-info { color: #94a3b8; font-size: 0.8rem; margin-top: 5px; }

        .bingo-header { display: grid; grid-template-columns: repeat(5, 1fr); max-width: 350px; margin: 10px auto 0; font-weight: 900; font-size: 1.5rem; color: var(--yellow); }
        .grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; max-width: 350px; margin: 0 auto; background: #334155; padding: 10px; border-radius: 0 0 10px 10px; }
        .cell { aspect-ratio: 1; background: #1e293b; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; font-weight: bold; cursor: pointer; border: 1px solid #475569; }
        .cell.marked { background: var(--red); border-color: white; box-shadow: inset 0 0 10px rgba(0,0,0,0.5); }
        
        .bingo-btn { margin-top: 20px; background: var(--green); color: white; border: none; padding: 15px 50px; font-size: 1.4rem; border-radius: 30px; font-weight: bold; width: 80%; cursor: pointer; }
    </style>
</head>
<body>

    <div class="header">
        <span id="current-num">--</span>
        <div id="card-info">Card ID: <span id="card-id">#0000</span> | ያመለጡ ቁጥሮች: <span id="history"></span></div>
    </div>

    <div class="bingo-header">
        <span>B</span><span>I</span><span>N</span><span>G</span><span>O</span>
    </div>
    <div class="grid" id="board"></div>

    <button class="bingo-btn" onclick="claimBingo()">BINGO!</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand(); // ገጹን ሙሉ እንዲሆን ያደርገዋል

        let calledNumbers = [];
        let markedNumbers = [];
        const cardID = Math.floor(1000 + Math.random() * 9000);
        document.getElementById('card-id').innerText = "#" + cardID;

        function createBoard() {
            const boardDiv = document.getElementById('board');
            const ranges = [[1,15],[16,30],[31,45],[46,60],[61,75]];
            
            for(let r=0; r<5; r++){
                for(let c=0; c<5; c++){
                    let min = ranges[c][0], max = ranges[c][1];
                    let val = (r===2 && c===2) ? "FREE" : Math.floor(Math.random()*(max-min+1))+min;
                    
                    let div = document.createElement('div');
                    div.className = 'cell' + (val==="FREE" ? " marked" : "");
                    div.innerText = val;
                    div.onclick = function() {
                        if(calledNumbers.includes(parseInt(val)) || val==="FREE") {
                            this.classList.toggle('marked');
                            if(this.classList.contains('marked')) markedNumbers.push(val);
                        }
                    };
                    boardDiv.appendChild(div);
                }
            }
        }

        function drawNumber() {
            if (calledNumbers.length >= 75) return;
            let n;
            do { n = Math.floor(Math.random() * 75) + 1; } while (calledNumbers.includes(n));
            calledNumbers.push(n);
            document.getElementById('current-num').innerText = n;
            document.getElementById('history').innerText = calledNumbers.slice(-3).reverse().join(", ");
        }

        function claimBingo() {
            const data = {
                action: "BINGO_CLAIM",
                card_id: cardID,
                marked: markedNumbers
            };
            tg.sendData(JSON.stringify(data)); // መረጃውን ወደ ቦቱ ይልካል
            alert("BINGO! መረጃው ለዳኛው ተልኳል።");
        }

        createBoard();
        setInterval(drawNumber, 5000);
    </script>
</body>
</html>


